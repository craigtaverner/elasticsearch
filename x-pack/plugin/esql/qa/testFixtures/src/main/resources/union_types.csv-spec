singleIndexIp
FROM sample_data
| EVAL client_ip = TO_IP(client_ip)
| KEEP @timestamp, client_ip, event_duration, message
;

@timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

singleIndexIpStats
FROM sample_data
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip  
4           |  172.21.3.15
1           |  172.21.0.5
1           |  172.21.2.113
1           |  172.21.2.162
;

singleIndexIpStringStats
FROM sample_data_str
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip
4           |  172.21.3.15
1           |  172.21.0.5
1           |  172.21.2.113
1           |  172.21.2.162
;

multiIndexIpString
required_feature: esql.union_types

FROM sample_data* METADATA _index
| EVAL client_ip = TO_IP(client_ip)
| KEEP _index, @timestamp, client_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  client_ip:ip  |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringRename
required_feature: esql.union_types

FROM sample_data* METADATA _index
| EVAL host_ip = TO_IP(client_ip)
| KEEP _index, @timestamp, host_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  host_ip:ip    |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15   |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15   |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15   |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15   |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5    |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringRenameToString
required_feature: esql.union_types

FROM sample_data* METADATA _index
| EVAL host_ip = TO_STRING(TO_IP(client_ip))
| KEEP _index, @timestamp, host_ip, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  host_ip:keyword  |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data     | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data     | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data     | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data     | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data     | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T13:55:01.543Z  |  172.21.3.15      |  1756467              |  Connected to 10.1.0.1
sample_data_str | 2023-10-23T13:53:55.832Z  |  172.21.3.15      |  5033755              |  Connection error
sample_data_str | 2023-10-23T13:52:55.015Z  |  172.21.3.15      |  8268153              |  Connection error
sample_data_str | 2023-10-23T13:51:54.732Z  |  172.21.3.15      |  725448               |  Connection error
sample_data_str | 2023-10-23T13:33:34.937Z  |  172.21.0.5       |  1232382              |  Disconnected
sample_data_str | 2023-10-23T12:27:28.948Z  |  172.21.2.113     |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  172.21.2.162     |  3450233              |  Connected to 10.1.0.3
;

multiIndexWhereIpString
required_feature: esql.union_types

FROM sample_data* METADATA _index
| WHERE STARTS_WITH(TO_STRING(client_ip), "172.21.2")
| KEEP _index, @timestamp, event_duration, message
| SORT _index ASC, @timestamp DESC
;

_index:keyword  | @timestamp:date           |  event_duration:long  |  message:keyword
sample_data     | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data     | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
sample_data_str | 2023-10-23T12:27:28.948Z  |  2764889              |  Connected to 10.1.0.2
sample_data_str | 2023-10-23T12:15:03.360Z  |  3450233              |  Connected to 10.1.0.3
;

multiIndexIpStringStats
required_feature: esql.union_types

FROM sample_data*
| EVAL client_ip = TO_IP(client_ip)
| STATS count=count(*) BY client_ip
| SORT count DESC, client_ip ASC
| KEEP count, client_ip
;

count:long  |  client_ip:ip
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexIpStringRenameStats
required_feature: esql.union_types

FROM sample_data*
| EVAL host_ip = TO_IP(client_ip)
| STATS count=count(*) BY host_ip
| SORT count DESC, host_ip ASC
| KEEP count, host_ip
;

count:long  |  host_ip:ip
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexIpStringRenameToStringStats
required_feature: esql.union_types

FROM sample_data*
| EVAL host_ip = TO_STRING(TO_IP(client_ip))
| STATS count=count(*) BY host_ip
| SORT count DESC, host_ip ASC
| KEEP count, host_ip
;

count:long  |  host_ip:keyword
8           |  172.21.3.15
2           |  172.21.0.5
2           |  172.21.2.113
2           |  172.21.2.162
;

multiIndexWhereIpStringStats
required_feature: esql.union_types

FROM sample_data*
| WHERE STARTS_WITH(TO_STRING(client_ip), "172.21.2")
| STATS count=count(*) BY message
| SORT count DESC, message ASC
| KEEP count, message
;

count:long  |  message:keyword
2           |  Connected to 10.1.0.2
2           |  Connected to 10.1.0.3
;
